## 今日完成
- 完成 Day4 工程化收尾：补齐项目 README（启动方式、provider 切换、WSL2 访问 Windows Ollama 的说明、常见排错）
- Ollama 配置进一步「环境变量化」：`OLLAMA_BASE_URL / OLLAMA_MODEL / OLLAMA_TIMEOUT_S`（便于不同机器/不同模型快速切换）
- 引入最小自动化测试（pytest）并通过验收：
  - `tests/test_health.py`：验证 `/health` 返回 200 且 `status=ok`
  - `tests/test_chat_mock.py`：验证 `provider=mock` 的 `/chat` 返回包含 `trace_id` 与 `answer`
- 修复 pytest 导入路径问题：新增 `tests/conftest.py` 将项目根目录加入 `sys.path`，解决 `ModuleNotFoundError: No module named 'src'`
- 完成提交与推送：`a9c3f53 day4: add README, env config, and basic tests`

## 今日卡点
- pytest 收集阶段报错：`ModuleNotFoundError: No module named 'src'`
  - 原因：pytest 运行时的模块搜索路径不包含项目根目录，`src` 不是已安装包
  - 解决：在 `tests/conftest.py` 中把项目根目录写入 `sys.path`（或临时用 `PYTHONPATH=.` 运行）
- （可选记录）WSL2/Windows 网络差异仍需牢记：WSL 的 `127.0.0.1` ≠ Windows 的 `localhost`

## 明日计划（不超过3条）
- 统一 Streaming 的输出格式（建议升级为 SSE：`text/event-stream`），并完善流式错误处理（错误也能被前端正确识别）
- 增强可观测性：将关键配置与 provider 打到日志里（trace_id + provider + model + latency）
- 增加更贴近业务的接口契约：为 chat 增加 `metadata`（provider/model/usage 等），并补 1-2 个回归测试

## 面试自测要点（要点式）
1) 为什么一定要写 README？
   - 让别人（面试官/同事/未来的你）在 1 分钟内跑起来；体现工程交付意识
2) 为什么把 Ollama 配置做成环境变量？
   - 解耦代码与环境：不同机器/不同模型/不同端口不改代码，只改 env；利于部署与排障
3) pytest 为什么会找不到 `src`？你怎么修的？
   - `src` 不是 installed package，pytest 的 import path 默认不含项目根目录
   - 用 `tests/conftest.py` 把 root 加入 `sys.path`，或临时用 `PYTHONPATH=. pytest`
4) 这两个测试覆盖了什么价值？
   - `/health`：服务活性探针与回归
   - `/chat mock`：接口契约不回归（至少保证最基本请求/响应结构稳定）
5) 你如何保证“改引擎不影响 API”？
   - 通过 Engine 抽象 + provider 工厂 + 测试回归，确保路由层契约稳定

## 今日验收命令（备忘）
- 运行测试：
  - `pytest -q`
- 启动服务：
  - `python -m uvicorn src.app.main:app --reload --port 8000`
- 健康检查：
  - `curl http://localhost:8000/health`
- 调用 mock：
  - `curl -s -X POST http://localhost:8000/chat -H "Content-Type: application/json" -d '{"provider":"mock","messages":[{"role":"user","content":"hi"}]}' | cat`
